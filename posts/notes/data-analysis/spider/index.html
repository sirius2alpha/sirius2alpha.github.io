<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用Selenium库爬取网易云音乐和携程旅行评论 | Sirius' Blog</title>
<meta name=keywords content="Selenium,爬虫,网易云音乐,携程旅行"><meta name=description content="记录使用Selenium爬取网易云和携程旅行评论的过程"><meta name=author content="sirius1y"><link rel=canonical href=https://sirius1y.top/posts/notes/data-analysis/spider/><link crossorigin=anonymous href=/assets/css/stylesheet.3551607c8eb1ef998f0b6c81d22f9f03dd2c3b8ecaf983e42c023e8d41e39f66.css integrity="sha256-NVFgfI6x75mPC2yB0i+fA90sO47K+YPkLAI+jUHjn2Y=" rel="preload stylesheet" as=style><link rel=icon href=https://sirius1y.top/images/icon.png><link rel=icon type=image/png sizes=16x16 href=https://sirius1y.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sirius1y.top/favicon-32x32.png><link rel=apple-touch-icon href=https://sirius1y.top/apple-touch-icon.png><link rel=mask-icon href=https://sirius1y.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sirius1y.top/posts/notes/data-analysis/spider/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="使用Selenium库爬取网易云音乐和携程旅行评论"><meta property="og:description" content="记录使用Selenium爬取网易云和携程旅行评论的过程"><meta property="og:type" content="article"><meta property="og:url" content="https://sirius1y.top/posts/notes/data-analysis/spider/"><meta property="og:image" content="https://sirius1y.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-14T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-14T00:00:00+00:00"><meta property="og:site_name" content="Sirius' Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sirius1y.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="使用Selenium库爬取网易云音乐和携程旅行评论"><meta name=twitter:description content="记录使用Selenium爬取网易云和携程旅行评论的过程"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sirius1y.top/posts/"},{"@type":"ListItem","position":2,"name":"使用Selenium库爬取网易云音乐和携程旅行评论","item":"https://sirius1y.top/posts/notes/data-analysis/spider/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用Selenium库爬取网易云音乐和携程旅行评论","name":"使用Selenium库爬取网易云音乐和携程旅行评论","description":"记录使用Selenium爬取网易云和携程旅行评论的过程","keywords":["Selenium","爬虫","网易云音乐","携程旅行"],"articleBody":"网络爬虫记录 前置知识 网站的加载形式有两种：静态加载和动态加载\n静态加载 在静态加载中，当你访问一个网页时，服务器会发送一个完整的HTML页面。\n所有的内容，包括文本、图片和链接，都嵌入在这个HTML文档中。\nCSS和JavaScript通常作为外部文件加载，但它们主要用于增强页面的外观和感觉，而不是改变内容。\n对爬虫的影响：\n易于爬取：静态页面可以直接通过HTTP请求获取，然后使用HTML解析器（如BeautifulSoup）提取所需信息。\n无需执行JavaScript：不需要处理JavaScript生成的内容。\n动态加载 动态加载的网页通常使用Ajax（Asynchronous JavaScript and XML）或其他JavaScript框架来异步加载数据。\n当你访问这样的网页时，初始的HTML文档可能不包含所有内容。随后，JavaScript会被执行来加载更多数据。\n这些数据可能来自服务器的额外HTTP请求，通常返回JSON或XML格式的数据。\n对爬虫的影响：\n更复杂的爬取过程：由于内容是动态加载的，传统的HTTP请求和HTML解析可能无法获取所有数据。\n需要模拟浏览器或分析JavaScript：可能需要使用如Selenium之类的工具来模拟浏览器行为，或分析JavaScript代码和网络请求来直接获取数据。\n可能涉及到更多的反爬机制：动态加载的网站可能有更复杂的反爬虫策略。\nSelenium库 在刷新网易云音乐的一首歌曲下面的评论的时候，发现浏览器的URL都没有发生变化，应该是采用Ajax刷新了网页的部分内容。\n对于这样网站的爬虫有两个思路：\n在浏览器的控制台上刷新时候查看“网络”部分，分析发送的请求，在相应的进行模拟 使用selenium工具进行模拟 本次任务采用selenium进行模拟进行爬取评论。\n然后会得到一堆.txt文件，用python或者shell脚本把他们合在一起，接下来进行数据分析\n代码附录 代码1 网易云音乐评论网络爬虫 from selenium import webdriver from selenium.webdriver.common.by import By from time import sleep # 创建ChromeOptions对象并启用无头模式 chrome_options = webdriver.ChromeOptions() chrome_options.add_argument('--headless') driver = webdriver.Chrome(options=chrome_options) # 打开网站 driver.get('https://music.163.com/#/song?id=1392155391') # 设定起始页号 page_number = 1 # 定位元素框架 comment_frame = driver.switch_to.frame('g_iframe') while page_number\u003c260: # 滚动到页面底部，确保所有的评论都被加载 driver.execute_script(\"window.scrollTo(0, document.body.scrollHeight);\") # 等待一段时间，让评论加载 sleep(2) # 定位评论和时间 comments = driver.find_elements(By.CSS_SELECTOR, \".cnt.f-brk\") times = driver.find_elements(By.CSS_SELECTOR, \".time.s-fc4\") # 写入到文件 with open(f'comments_page_{page_number}.txt', 'w', encoding='utf-8') as f: for comment in comments: # 提取评论用户名、文本、时间 text = comment.text time = times[comments.index(comment)].text # 在控制台打印评论 print(f'page_{page_number}:'+time+' '+text) # 写入文件 f.write(time+' '+text + '\\n') # 翻到下一页 try: next_page_button = driver.find_element(By.CSS_SELECTOR, '.zbtn.znxt') next_page_button.click() page_number += 1 except Exception as e: # 如果找不到 \"下一页\" 按钮，说明已经到达最后一页，跳出循环 break # 事实上，他会一直在最后一个页面循环输出相同的结果 # 解决方法1：手动终止程序，删除多余的txt # 解决方法2：写成for循环，硬编码最大页数 # !!这里采用了硬编码最大页数的方法 # 关闭浏览器和结束 WebDriver 会话 driver.quit() 代码2 携程旅行网站爬虫 from selenium import webdriver from selenium.webdriver.common.by import By from time import sleep from bs4 import BeautifulSoup # 创建ChromeOptions对象并启用无头模式 chrome_options = webdriver.ChromeOptions() chrome_options.add_argument('--headless') driver = webdriver.Chrome(options=chrome_options) # 打开网站 driver.get('https://you.ctrip.com/sight/pancounty2369/134972.html') # 设定起始页号 page_number = 1 # 点击按照时间排序 element = driver.find_element(By.CSS_SELECTOR,'.sortTag') element.click() while page_number\u003c141: # 滚动到页面底部，确保所有的评论都被加载 driver.execute_script(\"window.scrollTo(0, document.body.scrollHeight);\") # 等待一段时间，让评论加载 sleep(2) # 定位评论和IP地址 comments = driver.find_elements(By.CSS_SELECTOR, \".commentDetail\") times= driver.find_elements(By.CSS_SELECTOR, \".commentTime\") ipContent = driver.find_elements(By.CSS_SELECTOR, \".ipContent\") # 写入到文件 with open(f'comments_page_{page_number}.txt', 'w', encoding='utf-8') as f: for comment, time in zip(comments, times): # 提取评论用户名、文本、时间 text = comment.text ip = ipContent[comments.index(comment)].text # 获取 WebElement 对象的 outerHTML 属性 html = time.get_attribute('outerHTML') soup = BeautifulSoup(html, 'html.parser') # 找到 div 和 span 元素 div = soup.find('div', class_='commentTime') span = div.find('span', class_='ipContent') # 获取 div 和 span 的文本 div_text = div.get_text(strip=True) span_text = span.get_text(strip=True) # 从 div 的文本中移除 span 的文本 time_text = div_text.replace(span_text, '') # 在控制台打印评论 print(f'page_{page_number}:' + ip + ' ' + time_text + ' ' + text) # 写入文件 f.write(ip + ' ' + time_text + ' ' + text + '\\n') # 翻到下一页 try: next_page_button = driver.find_element(By.CSS_SELECTOR, '.ant-pagination-next') # next_page_button.click() driver.execute_script(\"arguments[0].click();\", next_page_button) page_number += 1 except Exception as e: # 如果找不到 \"下一页\" 按钮，说明已经到达最后一页，跳出循环 print(\"没有找到下一页\") print(e) break # 事实上，他会一直在最后一个页面循环输出相同的结果 # 解决方法1：手动终止程序，删除多余的txt # 解决方法2：写成for循环，硬编码最大页数 # !!这里采用了硬编码最大页数的方法 # 关闭浏览器和结束 WebDriver 会话 driver.quit() 代码3 merge_all_txt.py import glob # 找到所有的 'comments_page_{page_number}.txt' 文件 filenames = glob.glob('comments_page_*.txt') # 打开 'comments.txt' 文件 with open('comments.txt', 'w', encoding='utf-8') as outfile: for fname in filenames: # 打开每个 'comments_page_{page_number}.txt' 文件 with open(fname, 'r', encoding='utf-8') as infile: # 将文件的内容写入到 'comments.txt' 文件中 for line in infile: outfile.write(line) ","wordCount":"393","inLanguage":"en","image":"https://sirius1y.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-02-14T00:00:00Z","dateModified":"2024-02-14T00:00:00Z","author":{"@type":"Person","name":"sirius1y"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sirius1y.top/posts/notes/data-analysis/spider/"},"publisher":{"@type":"Organization","name":"Sirius' Blog","logo":{"@type":"ImageObject","url":"https://sirius1y.top/images/icon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sirius1y.top/ accesskey=h title="Home (Alt + H)"><img src=https://sirius1y.top/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sirius1y.top/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sirius1y.top/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://sirius1y.top/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://sirius1y.top/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sirius1y.top/>Home</a>&nbsp;»&nbsp;<a href=https://sirius1y.top/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">使用Selenium库爬取网易云音乐和携程旅行评论</h1><div class=post-description>记录使用Selenium爬取网易云和携程旅行评论的过程</div><div class=post-meta><span title='2024-02-14 00:00:00 +0000 UTC'>February 14, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;393 words&nbsp;·&nbsp;sirius1y</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%bd%91%e7%bb%9c%e7%88%ac%e8%99%ab%e8%ae%b0%e5%bd%95 aria-label=网络爬虫记录>网络爬虫记录</a><ul><li><a href=#%e5%89%8d%e7%bd%ae%e7%9f%a5%e8%af%86 aria-label=前置知识>前置知识</a><ul><li><a href=#%e9%9d%99%e6%80%81%e5%8a%a0%e8%bd%bd aria-label=静态加载>静态加载</a></li><li><a href=#%e5%8a%a8%e6%80%81%e5%8a%a0%e8%bd%bd aria-label=动态加载>动态加载</a></li></ul></li><li><a href=#selenium%e5%ba%93 aria-label=Selenium库>Selenium库</a></li><li><a href=#%e4%bb%a3%e7%a0%81%e9%99%84%e5%bd%95 aria-label=代码附录>代码附录</a><ul><li><a href=#%e4%bb%a3%e7%a0%811-%e7%bd%91%e6%98%93%e4%ba%91%e9%9f%b3%e4%b9%90%e8%af%84%e8%ae%ba%e7%bd%91%e7%bb%9c%e7%88%ac%e8%99%ab aria-label="代码1 网易云音乐评论网络爬虫">代码1 网易云音乐评论网络爬虫</a></li><li><a href=#%e4%bb%a3%e7%a0%812-%e6%90%ba%e7%a8%8b%e6%97%85%e8%a1%8c%e7%bd%91%e7%ab%99%e7%88%ac%e8%99%ab aria-label="代码2 携程旅行网站爬虫">代码2 携程旅行网站爬虫</a></li><li><a href=#%e4%bb%a3%e7%a0%813-merge_all_txtpy aria-label="代码3 merge_all_txt.py">代码3 merge_all_txt.py</a></li></ul></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=网络爬虫记录>网络爬虫记录<a hidden class=anchor aria-hidden=true href=#网络爬虫记录>#</a></h1><h2 id=前置知识>前置知识<a hidden class=anchor aria-hidden=true href=#前置知识>#</a></h2><p>网站的加载形式有两种：静态加载和动态加载</p><h3 id=静态加载>静态加载<a hidden class=anchor aria-hidden=true href=#静态加载>#</a></h3><p>在静态加载中，当你访问一个网页时，服务器会发送一个完整的HTML页面。</p><p>所有的内容，包括文本、图片和链接，都嵌入在这个HTML文档中。</p><p>CSS和JavaScript通常作为外部文件加载，但它们主要用于增强页面的外观和感觉，而不是改变内容。</p><p><strong>对爬虫的影响：</strong></p><p>易于爬取：静态页面可以直接通过HTTP请求获取，然后使用HTML解析器（如BeautifulSoup）提取所需信息。</p><p>无需执行JavaScript：不需要处理JavaScript生成的内容。</p><h3 id=动态加载>动态加载<a hidden class=anchor aria-hidden=true href=#动态加载>#</a></h3><p>动态加载的网页通常使用Ajax（Asynchronous JavaScript and XML）或其他JavaScript框架来异步加载数据。</p><p>当你访问这样的网页时，初始的HTML文档可能不包含所有内容。随后，JavaScript会被执行来加载更多数据。</p><p>这些数据可能来自服务器的额外HTTP请求，通常返回JSON或XML格式的数据。</p><p><strong>对爬虫的影响：</strong></p><p>更复杂的爬取过程：由于内容是动态加载的，传统的HTTP请求和HTML解析可能无法获取所有数据。</p><p>需要模拟浏览器或分析JavaScript：可能需要使用如Selenium之类的工具来模拟浏览器行为，或分析JavaScript代码和网络请求来直接获取数据。</p><p>可能涉及到更多的反爬机制：动态加载的网站可能有更复杂的反爬虫策略。</p><h2 id=selenium库>Selenium库<a hidden class=anchor aria-hidden=true href=#selenium库>#</a></h2><p>在刷新网易云音乐的一首歌曲下面的评论的时候，发现浏览器的URL都没有发生变化，应该是采用Ajax刷新了网页的部分内容。</p><p>对于这样网站的爬虫有两个思路：</p><ol><li>在浏览器的控制台上刷新时候查看“网络”部分，分析发送的请求，在相应的进行模拟</li><li>使用selenium工具进行模拟</li></ol><p>本次任务采用selenium进行模拟进行爬取评论。</p><p>然后会得到一堆.txt文件，用python或者shell脚本把他们合在一起，接下来进行数据分析</p><h2 id=代码附录>代码附录<a hidden class=anchor aria-hidden=true href=#代码附录>#</a></h2><h3 id=代码1-网易云音乐评论网络爬虫>代码1 网易云音乐评论网络爬虫<a hidden class=anchor aria-hidden=true href=#代码1-网易云音乐评论网络爬虫>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.common.by</span> <span class=kn>import</span> <span class=n>By</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 创建ChromeOptions对象并启用无头模式</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>ChromeOptions</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--headless&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>options</span><span class=o>=</span><span class=n>chrome_options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 打开网站</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://music.163.com/#/song?id=1392155391&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 设定起始页号</span>
</span></span><span class=line><span class=cl><span class=n>page_number</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定位元素框架</span>
</span></span><span class=line><span class=cl><span class=n>comment_frame</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>switch_to</span><span class=o>.</span><span class=n>frame</span><span class=p>(</span><span class=s1>&#39;g_iframe&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>page_number</span><span class=o>&lt;</span><span class=mi>260</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 滚动到页面底部，确保所有的评论都被加载</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;window.scrollTo(0, document.body.scrollHeight);&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 等待一段时间，让评论加载</span>
</span></span><span class=line><span class=cl>    <span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 定位评论和时间</span>
</span></span><span class=line><span class=cl>    <span class=n>comments</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_elements</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.cnt.f-brk&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>times</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_elements</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.time.s-fc4&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 写入到文件</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;comments_page_</span><span class=si>{</span><span class=n>page_number</span><span class=si>}</span><span class=s1>.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>comment</span> <span class=ow>in</span> <span class=n>comments</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 提取评论用户名、文本、时间</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span> <span class=o>=</span> <span class=n>comment</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span> <span class=o>=</span> <span class=n>times</span><span class=p>[</span><span class=n>comments</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>comment</span><span class=p>)]</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>            <span class=c1># 在控制台打印评论</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;page_</span><span class=si>{</span><span class=n>page_number</span><span class=si>}</span><span class=s1>:&#39;</span><span class=o>+</span><span class=n>time</span><span class=o>+</span><span class=s1>&#39; &#39;</span><span class=o>+</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 写入文件</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>time</span><span class=o>+</span><span class=s1>&#39; &#39;</span><span class=o>+</span><span class=n>text</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 翻到下一页</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>next_page_button</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s1>&#39;.zbtn.znxt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>next_page_button</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>page_number</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 如果找不到 &#34;下一页&#34; 按钮，说明已经到达最后一页，跳出循环</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 事实上，他会一直在最后一个页面循环输出相同的结果</span>
</span></span><span class=line><span class=cl>        <span class=c1># 解决方法1：手动终止程序，删除多余的txt</span>
</span></span><span class=line><span class=cl>        <span class=c1># 解决方法2：写成for循环，硬编码最大页数</span>
</span></span><span class=line><span class=cl>        <span class=c1># !!这里采用了硬编码最大页数的方法</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># 关闭浏览器和结束 WebDriver 会话</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=代码2-携程旅行网站爬虫>代码2 携程旅行网站爬虫<a hidden class=anchor aria-hidden=true href=#代码2-携程旅行网站爬虫>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>selenium.webdriver.common.by</span> <span class=kn>import</span> <span class=n>By</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>time</span> <span class=kn>import</span> <span class=n>sleep</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>bs4</span> <span class=kn>import</span> <span class=n>BeautifulSoup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 创建ChromeOptions对象并启用无头模式</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>ChromeOptions</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>chrome_options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;--headless&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>options</span><span class=o>=</span><span class=n>chrome_options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 打开网站</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://you.ctrip.com/sight/pancounty2369/134972.html&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 设定起始页号</span>
</span></span><span class=line><span class=cl><span class=n>page_number</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 点击按照时间排序</span>
</span></span><span class=line><span class=cl><span class=n>element</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span><span class=s1>&#39;.sortTag&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>element</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>page_number</span><span class=o>&lt;</span><span class=mi>141</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 滚动到页面底部，确保所有的评论都被加载</span>
</span></span><span class=line><span class=cl>    <span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;window.scrollTo(0, document.body.scrollHeight);&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 等待一段时间，让评论加载</span>
</span></span><span class=line><span class=cl>    <span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 定位评论和IP地址</span>
</span></span><span class=line><span class=cl>    <span class=n>comments</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_elements</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.commentDetail&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>times</span><span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_elements</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.commentTime&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ipContent</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_elements</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s2>&#34;.ipContent&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 写入到文件</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;comments_page_</span><span class=si>{</span><span class=n>page_number</span><span class=si>}</span><span class=s1>.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>comment</span><span class=p>,</span> <span class=n>time</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>comments</span><span class=p>,</span> <span class=n>times</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 提取评论用户名、文本、时间</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span> <span class=o>=</span> <span class=n>comment</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span> <span class=o>=</span> <span class=n>ipContent</span><span class=p>[</span><span class=n>comments</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>comment</span><span class=p>)]</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># 获取 WebElement 对象的 outerHTML 属性</span>
</span></span><span class=line><span class=cl>            <span class=n>html</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>get_attribute</span><span class=p>(</span><span class=s1>&#39;outerHTML&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>html</span><span class=p>,</span> <span class=s1>&#39;html.parser&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># 找到 div 和 span 元素</span>
</span></span><span class=line><span class=cl>            <span class=n>div</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>,</span> <span class=n>class_</span><span class=o>=</span><span class=s1>&#39;commentTime&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>span</span> <span class=o>=</span> <span class=n>div</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;span&#39;</span><span class=p>,</span> <span class=n>class_</span><span class=o>=</span><span class=s1>&#39;ipContent&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># 获取 div 和 span 的文本</span>
</span></span><span class=line><span class=cl>            <span class=n>div_text</span> <span class=o>=</span> <span class=n>div</span><span class=o>.</span><span class=n>get_text</span><span class=p>(</span><span class=n>strip</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>span_text</span> <span class=o>=</span> <span class=n>span</span><span class=o>.</span><span class=n>get_text</span><span class=p>(</span><span class=n>strip</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># 从 div 的文本中移除 span 的文本</span>
</span></span><span class=line><span class=cl>            <span class=n>time_text</span> <span class=o>=</span> <span class=n>div_text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>span_text</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># 在控制台打印评论</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;page_</span><span class=si>{</span><span class=n>page_number</span><span class=si>}</span><span class=s1>:&#39;</span> <span class=o>+</span> <span class=n>ip</span> <span class=o>+</span> <span class=s1>&#39;   &#39;</span> <span class=o>+</span> <span class=n>time_text</span> <span class=o>+</span> <span class=s1>&#39;    &#39;</span> <span class=o>+</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># 写入文件</span>
</span></span><span class=line><span class=cl>            <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>ip</span> <span class=o>+</span> <span class=s1>&#39;   &#39;</span> <span class=o>+</span> <span class=n>time_text</span> <span class=o>+</span> <span class=s1>&#39;    &#39;</span> <span class=o>+</span> <span class=n>text</span> <span class=o>+</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 翻到下一页</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>next_page_button</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>CSS_SELECTOR</span><span class=p>,</span> <span class=s1>&#39;.ant-pagination-next&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># next_page_button.click()</span>
</span></span><span class=line><span class=cl>        <span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&#34;arguments[0].click();&#34;</span><span class=p>,</span> <span class=n>next_page_button</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>page_number</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 如果找不到 &#34;下一页&#34; 按钮，说明已经到达最后一页，跳出循环</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;没有找到下一页&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 事实上，他会一直在最后一个页面循环输出相同的结果</span>
</span></span><span class=line><span class=cl>        <span class=c1># 解决方法1：手动终止程序，删除多余的txt</span>
</span></span><span class=line><span class=cl>        <span class=c1># 解决方法2：写成for循环，硬编码最大页数</span>
</span></span><span class=line><span class=cl>        <span class=c1># !!这里采用了硬编码最大页数的方法</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># 关闭浏览器和结束 WebDriver 会话</span>
</span></span><span class=line><span class=cl><span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=代码3-merge_all_txtpy>代码3 merge_all_txt.py<a hidden class=anchor aria-hidden=true href=#代码3-merge_all_txtpy>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>glob</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 找到所有的 &#39;comments_page_{page_number}.txt&#39; 文件</span>
</span></span><span class=line><span class=cl><span class=n>filenames</span> <span class=o>=</span> <span class=n>glob</span><span class=o>.</span><span class=n>glob</span><span class=p>(</span><span class=s1>&#39;comments_page_*.txt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 打开 &#39;comments.txt&#39; 文件</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;comments.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>fname</span> <span class=ow>in</span> <span class=n>filenames</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 打开每个 &#39;comments_page_{page_number}.txt&#39; 文件</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>fname</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 将文件的内容写入到 &#39;comments.txt&#39; 文件中</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>outfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://sirius1y.top/tags/selenium/>Selenium</a></li><li><a href=https://sirius1y.top/tags/%E7%88%AC%E8%99%AB/>爬虫</a></li></ul><nav class=paginav><a class=prev href=https://sirius1y.top/posts/notes/tools/latex_resume/><span class=title>« Prev</span><br><span>使用LaTex制作中文简历</span>
</a><a class=next href=https://sirius1y.top/posts/notes/dev/dev-scoreboard/><span class=title>Next »</span><br><span>点击排行榜scoreboard</span></a></nav></footer><script>function createGiscusScript(e){const t=document.createElement("script");Object.entries(e).forEach(([e,n])=>t.setAttribute(e,n)),document.querySelector("article").appendChild(t);const n=document.querySelector('label[for="switch_default"]');n&&n.addEventListener("click",function(){const e=document.body.classList.contains("dark")?"transparent_dark":"light";t.setAttribute("data-theme",e),sendMessage({setConfig:{theme:e}})})}function sendMessage(e){const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")}document.addEventListener("DOMContentLoaded",function(){const e={src:"https://giscus.app/client.js","data-repo":"yunyit/yunyit.github.io","data-repo-id":"R_kgDOKqkPYw","data-category":"Comments","data-category-id":"DIC_kwDOKqkPY84CceDi","data-mapping":"url","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-lang":"en",crossorigin:"anonymous",async:""};e["data-theme"]=document.body.classList.contains("dark")?"transparent_dark":"light",createGiscusScript(e);const t=new MutationObserver(()=>{const e=document.body.classList.contains("dark")?"transparent_dark":"light";sendMessage({setConfig:{theme:e}})});t.observe(document.body,{attributes:!0,attributeFilter:["class"]})})</script></article></main><footer class=footer><span><a href=https://us.umami.is/websites/5e6ac0c1-e2b2-4d0f-9542-b79ac2cf89c4 rel="noopener noreferrer" target=_blank>Analysis</a>
</span>|
<script defer src=https://cloud.umami.is/script.js data-website-id=5e6ac0c1-e2b2-4d0f-9542-b79ac2cf89c4></script><span><a href=https://beian.miit.gov.cn/ target=_blank>渝ICP备2024018631号</a>
</span>|
<span>&copy; 2025 <a href=https://sirius1y.top/>Sirius' Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>