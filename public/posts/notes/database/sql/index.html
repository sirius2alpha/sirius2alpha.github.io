<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SQL学习笔记 | Sirius' Blog</title>
<meta name=keywords content="SQL,学习笔记"><meta name=description content="导出数据库为sql文件，在命令行中执行：
mysqldump -u root -p course-system > course-system.sql DDL(Data Definition Language)数据定义语言 操作库 -- 创建库 create database db1; -- 创建库是否存在，不存在则创建 create database if not exists db1; -- 查看所有数据库 show databases; -- 查看某个数据库的定义信息 show create database db1; -- 修改数据库字符信息 alter database db1 character set utf8; -- 删除数据库 drop database db1; -- 使用某一数据库 use db1; 操作表 -- 创建表 create table student( id int, name varchar(32), age int , score double(4,1), birthday date, insert_time timestamp ); -- 查看表结构 desc 表名; -- 查看创建表的SQL语句 show create table 表名; -- 修改表名 alter table 表名 rename to 新的表名; -- 添加一列 alter table 表名 add 列名 数据类型; -- 删除列 alter table 表名 drop 列名; -- 删除表 drop table 表名; drop table if exists 表名 ; DML(Data Manipulation Language)数据操作语言 增加 insert into -- 写全所有列名 insert into 表名(列名1,列名2,."><meta name=author content="sirius1y"><link rel=canonical href=//localhost:1313/posts/notes/database/sql/><link crossorigin=anonymous href=/assets/css/stylesheet.3551607c8eb1ef998f0b6c81d22f9f03dd2c3b8ecaf983e42c023e8d41e39f66.css integrity="sha256-NVFgfI6x75mPC2yB0i+fA90sO47K+YPkLAI+jUHjn2Y=" rel="preload stylesheet" as=style><link rel=icon href=//localhost:1313/images/icon.png><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=//localhost:1313/apple-touch-icon.png><link rel=mask-icon href=//localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/posts/notes/database/sql/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="SQL学习笔记"><meta property="og:description" content="导出数据库为sql文件，在命令行中执行：
mysqldump -u root -p course-system > course-system.sql DDL(Data Definition Language)数据定义语言 操作库 -- 创建库 create database db1; -- 创建库是否存在，不存在则创建 create database if not exists db1; -- 查看所有数据库 show databases; -- 查看某个数据库的定义信息 show create database db1; -- 修改数据库字符信息 alter database db1 character set utf8; -- 删除数据库 drop database db1; -- 使用某一数据库 use db1; 操作表 -- 创建表 create table student( id int, name varchar(32), age int , score double(4,1), birthday date, insert_time timestamp ); -- 查看表结构 desc 表名; -- 查看创建表的SQL语句 show create table 表名; -- 修改表名 alter table 表名 rename to 新的表名; -- 添加一列 alter table 表名 add 列名 数据类型; -- 删除列 alter table 表名 drop 列名; -- 删除表 drop table 表名; drop table if exists 表名 ; DML(Data Manipulation Language)数据操作语言 增加 insert into -- 写全所有列名 insert into 表名(列名1,列名2,."><meta property="og:type" content="article"><meta property="og:url" content="//localhost:1313/posts/notes/database/sql/"><meta property="og:image" content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-20T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-20T00:00:00+00:00"><meta property="og:site_name" content="Sirius' Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="SQL学习笔记"><meta name=twitter:description content="导出数据库为sql文件，在命令行中执行：
mysqldump -u root -p course-system > course-system.sql DDL(Data Definition Language)数据定义语言 操作库 -- 创建库 create database db1; -- 创建库是否存在，不存在则创建 create database if not exists db1; -- 查看所有数据库 show databases; -- 查看某个数据库的定义信息 show create database db1; -- 修改数据库字符信息 alter database db1 character set utf8; -- 删除数据库 drop database db1; -- 使用某一数据库 use db1; 操作表 -- 创建表 create table student( id int, name varchar(32), age int , score double(4,1), birthday date, insert_time timestamp ); -- 查看表结构 desc 表名; -- 查看创建表的SQL语句 show create table 表名; -- 修改表名 alter table 表名 rename to 新的表名; -- 添加一列 alter table 表名 add 列名 数据类型; -- 删除列 alter table 表名 drop 列名; -- 删除表 drop table 表名; drop table if exists 表名 ; DML(Data Manipulation Language)数据操作语言 增加 insert into -- 写全所有列名 insert into 表名(列名1,列名2,."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"SQL学习笔记","item":"//localhost:1313/posts/notes/database/sql/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SQL学习笔记","name":"SQL学习笔记","description":"导出数据库为sql文件，在命令行中执行：\nmysqldump -u root -p course-system \u0026gt; course-system.sql DDL(Data Definition Language)数据定义语言 操作库 -- 创建库 create database db1; -- 创建库是否存在，不存在则创建 create database if not exists db1; -- 查看所有数据库 show databases; -- 查看某个数据库的定义信息 show create database db1; -- 修改数据库字符信息 alter database db1 character set utf8; -- 删除数据库 drop database db1; -- 使用某一数据库 use db1; 操作表 -- 创建表 create table student( id int, name varchar(32), age int , score double(4,1), birthday date, insert_time timestamp ); -- 查看表结构 desc 表名; -- 查看创建表的SQL语句 show create table 表名; -- 修改表名 alter table 表名 rename to 新的表名; -- 添加一列 alter table 表名 add 列名 数据类型; -- 删除列 alter table 表名 drop 列名; -- 删除表 drop table 表名; drop table if exists 表名 ; DML(Data Manipulation Language)数据操作语言 增加 insert into -- 写全所有列名 insert into 表名(列名1,列名2,.","keywords":["SQL","学习笔记"],"articleBody":"导出数据库为sql文件，在命令行中执行：\nmysqldump -u root -p course-system \u003e course-system.sql DDL(Data Definition Language)数据定义语言 操作库 -- 创建库 create database db1; -- 创建库是否存在，不存在则创建 create database if not exists db1; -- 查看所有数据库 show databases; -- 查看某个数据库的定义信息 show create database db1; -- 修改数据库字符信息 alter database db1 character set utf8; -- 删除数据库 drop database db1; -- 使用某一数据库 use db1; 操作表 -- 创建表 create table student( id int, name varchar(32), age int , score double(4,1), birthday date, insert_time timestamp ); -- 查看表结构 desc 表名; -- 查看创建表的SQL语句 show create table 表名; -- 修改表名 alter table 表名 rename to 新的表名; -- 添加一列 alter table 表名 add 列名 数据类型; -- 删除列 alter table 表名 drop 列名; -- 删除表 drop table 表名; drop table if exists 表名 ; DML(Data Manipulation Language)数据操作语言 增加 insert into -- 写全所有列名 insert into 表名(列名1,列名2,...列名n) values(值1,值2,...值n); -- 不写列名（所有列全部添加） insert into 表名 values(值1,值2,...值n); -- 插入部分数据 insert into 表名(列名1,列名2) values(值1,值2); 删除 delete -- 删除表中数据 delete from 表名 where 列名 = 值; -- 删除表中所有数据 delete from 表名; -- 删除表中所有数据（高效 先删除表，然后再创建一张一样的表。） truncate table 表名; 修改 update -- 不带条件的修改(会修改所有行) update 表名 set 列名 = 值; -- 带条件的修改 update 表名 set 列名 = 值 where 列名=值; DCL(Data Control Language)数据控制语言 管理用户 添加用户 语法：CREATE USER ‘用户名’@‘主机名’ IDENTIFIED BY ‘密码’;\n删除用户 语法：DROP USER ‘用户名’@‘主机名’;\n权限管理 查询权限 -- 查询权限 SHOW GRANTS FOR '用户名'@'主机名'; SHOW GRANTS FOR 'lisi'@'%'; 授予权限 -- 授予权限 grant 权限列表 on 数据库名.表名 to '用户名'@'主机名'; -- 给张三用户授予所有权限，在任意数据库任意表上 GRANT ALL ON *.* TO 'zhangsan'@'localhost'; 撤销权限 -- 撤销权限： revoke 权限列表 on 数据库名.表名 from '用户名'@'主机名'; REVOKE UPDATE ON db3.`account` FROM 'lisi'@'%'; DQL(Data Query Language)数据查询语言 SQL查询的执行顺序 基础关键字 BETWEEN…AND （在什么之间）和 IN( 集合)\n-- 查询年龄大于等于20 小于等于30\tSELECT * FROM student WHERE age \u003e= 20 \u0026\u0026 age \u003c=30; SELECT * FROM student WHERE age \u003e= 20 AND age \u003c=30; SELECT * FROM student WHERE age BETWEEN 20 AND 30; -- 查询年龄22岁，18岁，25岁的信息 SELECT * FROM student WHERE age = 22 OR age = 18 OR age = 25 SELECT * FROM student WHERE age IN (22,18,25); is not null(不为null值) 与 like（模糊查询）、distinct（去除重复值）\n-- 查询英语成绩不为null SELECT * FROM student WHERE english IS NOT NULL; _:单个任意字符 %：多个任意字符 -- 查询姓马的有哪些？ like SELECT * FROM student WHERE NAME LIKE '马%'; -- 查询姓名第二个字是化的人\tSELECT * FROM student WHERE NAME LIKE \"_化%\";\t-- 查询姓名是3个字的人 SELECT * FROM student WHERE NAME LIKE '___';\t-- 查询姓名中包含德的人 SELECT * FROM student WHERE NAME LIKE '%德%'; -- 关键词 DISTINCT 用于返回唯一不同的值。 -- 语法：SELECT DISTINCT 列名称 FROM 表名称 SELECT DISTINCT NAME FROM student ; EXISTS EXISTS是返回boolean,不是返回的子查询。\n使用方法：\nSELECT xm FROM S WHERE EXISTS([conditions]...) WITH：创建临时表 with 语句相当于建立了一张 临时虚拟表\n即利用with子句为子查询的数据集作为一个内存临时表. 在内存中解析，提高执行效率.，并且提高SQL语句的可读性，用完即销毁。\n语法 可以同时定义多个临时表\nWith Subtable1 as (select 1...), //as和select中的括号都不能省略 Subtable2 as (select 2...), //后面的没有with，逗号分割，同一个主查询同级别地方，with子查询只能定义一次 … Subtablen as (select n...) //与下面的实际查询之间没有逗号 Select …. with子句相关总结：\n1.使用with子句可以让子查询重用相同的with查询块,通过select调用（with子句只能被select查询块引用），一般在with查询用到多次情况下。在引用的select语句之前定义,同级只能定义with关键字只能使用一次,多个用逗号分割。 2.with子句的返回结果存到用户的临时表空间中，只做一次查询，反复使用,提高效率。 3.在同级select前有多个查询定义的时候，第1个用with，后面的不用with，并且用逗号隔开。 5.最后一个with 子句与下面的查询之间不能有逗号，只通过右括号分割,with 子句的查询必须用括号括起来 6.如果定义了with子句，而在查询中不使用，那么会报ora-32035 错误：未引用在with子句中定义的查询名。（至少一个with查询的name未被引用，解决方法是移除未被引用的with查询），注意：只要后面有引用的就可以，不一定非要在主查询中引用，比如后面的with 查询也引用了，也是可以的。 7.前面的with子句定义的查询在后面的with子句中可以使用。但是一个with子句内部不能嵌套with子句。 8.当一个查询块名字和一个表名或其他的对象相同时，解析器从内向外搜索，优先使用子查询块名字。 9.with查询的结果列有别名，引用的时候必须使用别名或*。 ———————————————— 版权声明：本文为CSDN博主「事后诸葛亮」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。 原文链接：https://blog.csdn.net/zq9017197/article/details/5938514\nORDER BY：字段排序 语法：order by 子句\norder by 排序字段1 排序方式1 ， 排序字段2 排序方式2... 注意： 如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件。\n如果使用默认的 utf8mb4 字符编码，中文按照偏旁部首进行排序，拼音排序用ORDER BY CONVERT(列名 USING GBK) ASC/DESC\n-- 例子 SELECT * FROM person ORDER BY math; --默认升序 SELECT * FROM person ORDER BY math desc; --降序 GROUP BY：字段分组 group by的过程解析\n如图所示，使用GROUP BY name，就相当于使用name进行分组，name相同的都压缩到一行中去，如表3。\n然饿，因为每一行只能允许存在一个确定的值，所以需要对这种有多个的值的格子，进行多个输入、一个输出的聚合函数进行处理。\n所以说GROUP BY能查询的字段只有分组字段、聚合函数。\n-- 按照性别分组。分别查询男、女同学的平均分 SELECT sex , AVG(math) FROM student GROUP BY sex; group by 多个字段\n如group by name,number，我们可以把name和number 看成一个整体字段，以他们整体来进行分组的。\n场景：对某一列的数目进行筛选 比如至少玩过某两款游戏的玩家ID，就可以用count+group by+having进行条件筛选。比如：\nWHERE GNAME in ('王者荣耀','帝国时代') GROUP BY player.PID HAVING COUNT(PID)\u003e=2; HAVING：组条件 HAVING 大多数情况下和结合 GROUP BY 来使用，但不是一定要结合 GROUP BY 来使用\nSELECT cno, COUNT(*) nums FROM tbl_student_class GROUP BY cno HAVING COUNT(*) = 3; INNER JOIN 隐式内连接 使用where条件消除无用数据\n-- 查询员工表的名称，性别。部门表的名称 SELECT emp.name,emp.gender,dept.name FROM emp,dept WHERE emp.`dept_id` = dept.`id`; SELECT t1.name, -- 员工表的姓名 t1.gender,-- 员工表的性别 t2.name -- 部门表的名称 FROM emp t1, dept t2 WHERE t1.`dept_id` = t2.`id`; 显式内连接 -- 语法： select 字段列表 from 表名1 [inner] join 表名2 on 条件 -- 例如： SELECT * FROM emp INNER JOIN dept ON emp.`dept_id` = dept.`id`; SELECT * FROM emp JOIN dept ON emp.`dept_id` = dept.`id`; 外连接查询 LEFT JOIN 左外连接 – 查询的是左表所有数据以及其交集部分\n-- 语法：select 字段列表 from 表1 left [outer] join 表2 on 条件； -- 例子： -- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称 SELECT t1.*,t2.`name` FROM emp t1 LEFT JOIN dept t2 ON t1.`dept_id` = t2.`id`; RIGHT JOIN 右外连接 – 查询的是右表所有数据以及其交集部分\n-- 语法： select 字段列表 from 表1 right [outer] join 表2 on 条件； -- 例子： SELECT * FROM dept t2 RIGHT JOIN emp t1 ON t1.`dept_id` = t2.`id`; CASE 子句 Case具有两种格式。简单Case函数和Case搜索函数。\n--简单Case函数 CASE sex WHEN '1' THEN '男' WHEN '2' THEN '女' ELSE '其他' END --Case搜索函数 CASE WHEN sex = '1' THEN '男' WHEN sex = '2' THEN '女' ELSE '其他' END 这两种方式，可以实现相同的功能。简单Case函数的写法相对比较简洁，但是和Case搜索函数相比，功能方面会有些限制，比如写判断式。\n使用示例：\nINNER JOIN battle ON CASE WHEN battle.WINNER = 'PLAYER1' THEN battle.PLAYER1 WHEN battle.WINNER = 'PLAYER2' THEN battle.PLAYER2 ELSE NULL -- 如果 WINNER 不是 'PLAYER1' 或 'PLAYER2'，可以返回 NULL 或其他适当的值 END = player.PID 外键 外键的设置 用SQL语言设置外键：`[ CONSTRAINT `外键别名`] FOREIGN KEY (`受限制的列名`) REFERENCES `引用的表` (`引用的列名`)`\nCREATE TABLE `S` ( `xh` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL, `xm` varchar(255) NOT NULL, `xb` varchar(255) DEFAULT NULL, `csrq` varchar(255) DEFAULT NULL, `jg` varchar(255) DEFAULT NULL, `sjhm` varchar(255) DEFAULT NULL, `yxh` varchar(255) DEFAULT NULL, PRIMARY KEY (`xh`), KEY `idx1` (`yxh` DESC,`xm`) USING BTREE /*!80000 INVISIBLE */, KEY `学生表S院系号` (`yxh`), CONSTRAINT `学生表S院系号` FOREIGN KEY (`yxh`) REFERENCES `D` (`yxh`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci 外键是各个表之间的约束和联系，让数据更加合理。\n外键设置后，对添加和删除数据元素就有了先后顺序的要求。\n添加记录会出现的错误 如果想要在学生表S中添加院系号为04的学生，直接执行\nINSERT INTO `dbclass-school`.`S` (`xh`, `xm`, `xb`, `csrq`, `jg`, `sjhm`, `yxh`) VALUES ('1108', 'Kelvin', '男', '1993-08-16', '加州', '16301254638', '05'); 会出现报错：\nERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`dbclass-school`.`S`, CONSTRAINT `学生表S院系号` FOREIGN KEY (`yxh`) REFERENCES `D` (`yxh`)) 删除记录会出现的错误 在被引用的外键D.yxh删除记录，也会出现报错。\nmysql\u003e DELETE FROM D WHERE yxh='01'; ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`dbclass-school`.`S`, CONSTRAINT `学生表S院系号` FOREIGN KEY (`yxh`) REFERENCES `D` (`yxh`)) 正确的增删顺序是必要的 有顺序地增加记录 # 先添加D表中的院系号yxh mysql\u003e INSERT INTO `dbclass-school`.`D` (`yxh`,`Mc`,`dz`,`lxdh`) VALUES('04','美术学院','上大东校区五号楼','1234675427'); Query OK, 1 row affected (0.01 sec) mysql\u003e SELECT * FROM D; +-----+-----------------+--------------------------+------------+ | yxh | Mc | dz | lxdh | +-----+-----------------+--------------------------+------------+ | 01 | 计算机学院 | 上大东校区三号楼 | 65347567 | | 02 | 通讯学院 | 上大东校区二号楼 | 65341234 | | 03 | 材料学院 | 上大东校区四号楼 | 65347890 | | 04 | 美术学院 | 上大东校区五号楼 | 1234675427 | +-----+-----------------+--------------------------+------------+ 4 rows in set (0.00 sec) # 之后才能插入该院系号的学生 mysql\u003e INSERT INTO `dbclass-school`.`S` (`xh`, `xm`, `xb`, `csrq`, `jg`, `sjhm`, `yxh`) VALUES ('1109', 'Eva', '女', '1993-08-16', '加州', '16301254638', '04'); Query OK, 1 row affected (0.00 sec) mysql\u003e SELECT * FROM S; +------+-----------+------+------------+--------+-------------+------+ | xh | xm | xb | csrq | jg | sjhm | yxh | +------+-----------+------+------------+--------+-------------+------+ | 1101 | 李明 | 男 | 1993-03-06 | 上海 | 13613005486 | 02 | | 1102 | 刘晓明 | 男 | 1992-12-08 | 安徽 | 18913457890 | 01 | | 1103 | 张颖 | 女 | 1993-01-05 | 江苏 | 18826490423 | 01 | | 1104 | 刘晶晶 | 女 | 1994-11-06 | 上海 | 13331934111 | 01 | | 1105 | 刘成刚 | 男 | 1991-06-07 | 上海 | 18015872567 | 01 | | 1106 | 李二丽 | 女 | 1993-05-04 | 江苏 | 18107620945 | 01 | | 1107 | 张晓峰 | 男 | 1992-08-16 | 浙江 | 13912341078 | 01 | | 1108 | Kelvin | 男 | 1993-08-16 | 加州 | 16301254638 | 03 | | 1109 | Eva | 女 | 1993-08-16 | 加州 | 16301254638 | 04 | +------+-----------+------+------------+--------+-------------+------+ 9 rows in set (0.00 sec) 有顺序地删除记录 # 在外键被引用的时候不能直接删除被引用的内容 mysql\u003e DELETE FROM D WHERE yxh=04; ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`dbclass-school`.`S`, CONSTRAINT `学生表S院系号` FOREIGN KEY (`yxh`) REFERENCES `D` (`yxh`)) # 应该先删除学生表中引用该院系号的记录 mysql\u003e DELETE FROM S WHERE yxh=04; Query OK, 1 row affected (0.01 sec) # 最后才能删除逻辑上最底层的记录 mysql\u003e DELETE FROM D WHERE yxh=04; Query OK, 1 row affected (0.00 sec) 错误提示 Operand should contain 1 column(s)\n原因是我的子查询查询出的数据不止一个字段，但是我却在整体SQL中 把子查询出来的结果 作为一个字段的 NODE_ID 了\nSQL 参数错误\n这个问题的原因有很多，下面列出碰到的不易看出错误的：\nINNER JOIN rank ON player.RANK=rank.RID 应该改为：\nINNER JOIN `rank` ON player.RANK=`rank`.RID 因为rank是sql中的保留关键字，作为表名需要用``括起来，当然最好是不要使用这样的名字作为表名。\n","wordCount":"1255","inLanguage":"en","image":"//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2023-10-20T00:00:00Z","dateModified":"2023-10-20T00:00:00Z","author":{"@type":"Person","name":"sirius1y"},"mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/posts/notes/database/sql/"},"publisher":{"@type":"Organization","name":"Sirius' Blog","logo":{"@type":"ImageObject","url":"//localhost:1313/images/icon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=//localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=//localhost:1313/archives/ title=Archives><span>Archives</span></a></li><li><a href=//localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=//localhost:1313/posts/ title=Posts><span>Posts</span></a></li><li><a href=//localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">SQL学习笔记</h1><div class=post-meta><span title='2023-10-20 00:00:00 +0000 UTC'>October 20, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1255 words&nbsp;·&nbsp;sirius1y</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><li><a href=#ddldata-definition-language%e6%95%b0%e6%8d%ae%e5%ae%9a%e4%b9%89%e8%af%ad%e8%a8%80 aria-label="DDL(Data Definition Language)数据定义语言">DDL(Data Definition Language)数据定义语言</a><ul><li><a href=#%e6%93%8d%e4%bd%9c%e5%ba%93 aria-label=操作库>操作库</a></li><li><a href=#%e6%93%8d%e4%bd%9c%e8%a1%a8 aria-label=操作表>操作表</a></li></ul></li><li><a href=#dmldata-manipulation-language%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c%e8%af%ad%e8%a8%80 aria-label="DML(Data Manipulation Language)数据操作语言">DML(Data Manipulation Language)数据操作语言</a><ul><li><a href=#%e5%a2%9e%e5%8a%a0-insert-into aria-label="增加 insert into">增加 insert into</a></li><li><a href=#%e5%88%a0%e9%99%a4-delete aria-label="删除 delete">删除 delete</a></li><li><a href=#%e4%bf%ae%e6%94%b9-update aria-label="修改 update">修改 update</a></li></ul></li><li><a href=#dcldata-control-language%e6%95%b0%e6%8d%ae%e6%8e%a7%e5%88%b6%e8%af%ad%e8%a8%80 aria-label="DCL(Data Control Language)数据控制语言">DCL(Data Control Language)数据控制语言</a><ul><li><a href=#%e7%ae%a1%e7%90%86%e7%94%a8%e6%88%b7 aria-label=管理用户>管理用户</a><ul><li><a href=#%e6%b7%bb%e5%8a%a0%e7%94%a8%e6%88%b7 aria-label=添加用户>添加用户</a></li><li><a href=#%e5%88%a0%e9%99%a4%e7%94%a8%e6%88%b7 aria-label=删除用户>删除用户</a></li></ul></li><li><a href=#%e6%9d%83%e9%99%90%e7%ae%a1%e7%90%86 aria-label=权限管理>权限管理</a><ul><li><a href=#%e6%9f%a5%e8%af%a2%e6%9d%83%e9%99%90 aria-label=查询权限>查询权限</a></li><li><a href=#%e6%8e%88%e4%ba%88%e6%9d%83%e9%99%90 aria-label=授予权限>授予权限</a></li><li><a href=#%e6%92%a4%e9%94%80%e6%9d%83%e9%99%90 aria-label=撤销权限>撤销权限</a></li></ul></li></ul></li><li><a href=#dqldata-query-language%e6%95%b0%e6%8d%ae%e6%9f%a5%e8%af%a2%e8%af%ad%e8%a8%80 aria-label="DQL(Data Query Language)数据查询语言">DQL(Data Query Language)数据查询语言</a><ul><li><a href=#sql%e6%9f%a5%e8%af%a2%e7%9a%84%e6%89%a7%e8%a1%8c%e9%a1%ba%e5%ba%8f aria-label=SQL查询的执行顺序>SQL查询的执行顺序</a></li><li><a href=#%e5%9f%ba%e7%a1%80%e5%85%b3%e9%94%ae%e5%ad%97 aria-label=基础关键字>基础关键字</a></li><li><a href=#exists aria-label=EXISTS>EXISTS</a></li><li><a href=#with%e5%88%9b%e5%bb%ba%e4%b8%b4%e6%97%b6%e8%a1%a8 aria-label=WITH：创建临时表>WITH：创建临时表</a></li><li><a href=#order-by%e5%ad%97%e6%ae%b5%e6%8e%92%e5%ba%8f aria-label="ORDER BY：字段排序">ORDER BY：字段排序</a></li><li><a href=#group-by%e5%ad%97%e6%ae%b5%e5%88%86%e7%bb%84 aria-label="GROUP BY：字段分组">GROUP BY：字段分组</a><ul><li><a href=#%e5%9c%ba%e6%99%af%e5%af%b9%e6%9f%90%e4%b8%80%e5%88%97%e7%9a%84%e6%95%b0%e7%9b%ae%e8%bf%9b%e8%a1%8c%e7%ad%9b%e9%80%89 aria-label=场景：对某一列的数目进行筛选>场景：对某一列的数目进行筛选</a></li></ul></li><li><a href=#having%e7%bb%84%e6%9d%a1%e4%bb%b6 aria-label=HAVING：组条件>HAVING：组条件</a></li><li><a href=#inner-join aria-label="INNER JOIN">INNER JOIN</a><ul><li><a href=#%e9%9a%90%e5%bc%8f%e5%86%85%e8%bf%9e%e6%8e%a5 aria-label=隐式内连接>隐式内连接</a></li><li><a href=#%e6%98%be%e5%bc%8f%e5%86%85%e8%bf%9e%e6%8e%a5 aria-label=显式内连接>显式内连接</a></li></ul></li><li><a href=#%e5%a4%96%e8%bf%9e%e6%8e%a5%e6%9f%a5%e8%af%a2 aria-label=外连接查询>外连接查询</a><ul><li><a href=#left-join aria-label="LEFT JOIN">LEFT JOIN</a></li><li><a href=#right-join aria-label="RIGHT JOIN">RIGHT JOIN</a></li></ul></li><li><a href=#case-%e5%ad%90%e5%8f%a5 aria-label="CASE 子句">CASE 子句</a></li></ul></li></ul><li><a href=#%e5%a4%96%e9%94%ae aria-label=外键>外键</a><ul><ul><li><a href=#%e5%a4%96%e9%94%ae%e7%9a%84%e8%ae%be%e7%bd%ae aria-label=外键的设置>外键的设置</a></li><li><a href=#%e6%b7%bb%e5%8a%a0%e8%ae%b0%e5%bd%95%e4%bc%9a%e5%87%ba%e7%8e%b0%e7%9a%84%e9%94%99%e8%af%af aria-label=添加记录会出现的错误>添加记录会出现的错误</a></li><li><a href=#%e5%88%a0%e9%99%a4%e8%ae%b0%e5%bd%95%e4%bc%9a%e5%87%ba%e7%8e%b0%e7%9a%84%e9%94%99%e8%af%af aria-label=删除记录会出现的错误>删除记录会出现的错误</a></li><li><a href=#%e6%ad%a3%e7%a1%ae%e7%9a%84%e5%a2%9e%e5%88%a0%e9%a1%ba%e5%ba%8f%e6%98%af%e5%bf%85%e8%a6%81%e7%9a%84 aria-label=正确的增删顺序是必要的>正确的增删顺序是必要的</a><ul><li><a href=#%e6%9c%89%e9%a1%ba%e5%ba%8f%e5%9c%b0%e5%a2%9e%e5%8a%a0%e8%ae%b0%e5%bd%95 aria-label=有顺序地增加记录>有顺序地增加记录</a></li><li><a href=#%e6%9c%89%e9%a1%ba%e5%ba%8f%e5%9c%b0%e5%88%a0%e9%99%a4%e8%ae%b0%e5%bd%95 aria-label=有顺序地删除记录>有顺序地删除记录</a></li></ul></li></ul></ul></li><li><a href=#%e9%94%99%e8%af%af%e6%8f%90%e7%a4%ba aria-label=错误提示>错误提示</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>导出数据库为sql文件，在命令行中执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-b data-lang=b><span class=line><span class=cl><span class=c>mysqldump </span><span class=nb>-</span><span class=c>u root </span><span class=nb>-</span><span class=c>p course</span><span class=nb>-</span><span class=c>system </span><span class=nv>&gt;</span><span class=c> course</span><span class=nb>-</span><span class=c>system</span><span class=nt>.</span><span class=c>sql
</span></span></span></code></pre></div><h2 id=ddldata-definition-language数据定义语言>DDL(Data Definition Language)数据定义语言<a hidden class=anchor aria-hidden=true href=#ddldata-definition-language数据定义语言>#</a></h2><h3 id=操作库>操作库<a hidden class=anchor aria-hidden=true href=#操作库>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 创建库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>db1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 创建库是否存在，不存在则创建
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>exists</span><span class=w> </span><span class=n>db1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看所有数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=n>databases</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看某个数据库的定义信息 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>db1</span><span class=p>;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 修改数据库字符信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>alter</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>db1</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=n>utf8</span><span class=p>;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>drop</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>db1</span><span class=p>;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 使用某一数据库
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>use</span><span class=w> </span><span class=n>db1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=操作表>操作表<a hidden class=anchor aria-hidden=true href=#操作表>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 创建表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>student</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>int</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>name</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>32</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>score</span><span class=w> </span><span class=n>double</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>birthday</span><span class=w> </span><span class=nb>date</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>insert_time</span><span class=w> </span><span class=k>timestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看表结构
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>desc</span><span class=w> </span><span class=err>表名</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看创建表的SQL语句
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=err>表名</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 修改表名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>rename</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=err>新的表名</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 添加一列
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>add</span><span class=w> </span><span class=err>列名</span><span class=w> </span><span class=err>数据类型</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除列
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>drop</span><span class=w> </span><span class=err>列名</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除表
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>drop</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=err>表名</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>drop</span><span class=w> </span><span class=k>table</span><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=k>exists</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=dmldata-manipulation-language数据操作语言>DML(Data Manipulation Language)数据操作语言<a hidden class=anchor aria-hidden=true href=#dmldata-manipulation-language数据操作语言>#</a></h2><h3 id=增加-insert-into>增加 insert into<a hidden class=anchor aria-hidden=true href=#增加-insert-into>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 写全所有列名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=err>表名</span><span class=p>(</span><span class=err>列名</span><span class=mi>1</span><span class=p>,</span><span class=err>列名</span><span class=mi>2</span><span class=p>,...</span><span class=err>列名</span><span class=n>n</span><span class=p>)</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=err>值</span><span class=mi>1</span><span class=p>,</span><span class=err>值</span><span class=mi>2</span><span class=p>,...</span><span class=err>值</span><span class=n>n</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 不写列名（所有列全部添加）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=err>值</span><span class=mi>1</span><span class=p>,</span><span class=err>值</span><span class=mi>2</span><span class=p>,...</span><span class=err>值</span><span class=n>n</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 插入部分数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=err>表名</span><span class=p>(</span><span class=err>列名</span><span class=mi>1</span><span class=p>,</span><span class=err>列名</span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=err>值</span><span class=mi>1</span><span class=p>,</span><span class=err>值</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h3 id=删除-delete>删除 delete<a hidden class=anchor aria-hidden=true href=#删除-delete>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 删除表中数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>delete</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=err>列名</span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=err>值</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除表中所有数据
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>delete</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=err>表名</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 删除表中所有数据（高效 先删除表，然后再创建一张一样的表。）
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>truncate</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=err>表名</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=修改-update>修改 update<a hidden class=anchor aria-hidden=true href=#修改-update>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 不带条件的修改(会修改所有行)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>update</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=err>列名</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>值</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 带条件的修改
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>update</span><span class=w> </span><span class=err>表名</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=err>列名</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>值</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=err>列名</span><span class=o>=</span><span class=err>值</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=dcldata-control-language数据控制语言>DCL(Data Control Language)数据控制语言<a hidden class=anchor aria-hidden=true href=#dcldata-control-language数据控制语言>#</a></h2><h3 id=管理用户>管理用户<a hidden class=anchor aria-hidden=true href=#管理用户>#</a></h3><h4 id=添加用户>添加用户<a hidden class=anchor aria-hidden=true href=#添加用户>#</a></h4><p>语法：CREATE USER &lsquo;用户名&rsquo;@&lsquo;主机名&rsquo; IDENTIFIED BY &lsquo;密码&rsquo;;</p><h4 id=删除用户>删除用户<a hidden class=anchor aria-hidden=true href=#删除用户>#</a></h4><p>语法：DROP USER &lsquo;用户名&rsquo;@&lsquo;主机名&rsquo;;</p><h3 id=权限管理>权限管理<a hidden class=anchor aria-hidden=true href=#权限管理>#</a></h3><h4 id=查询权限>查询权限<a hidden class=anchor aria-hidden=true href=#查询权限>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查询权限
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=n>GRANTS</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=s1>&#39;用户名&#39;</span><span class=o>@</span><span class=s1>&#39;主机名&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SHOW</span><span class=w> </span><span class=n>GRANTS</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=s1>&#39;lisi&#39;</span><span class=o>@</span><span class=s1>&#39;%&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=授予权限>授予权限<a hidden class=anchor aria-hidden=true href=#授予权限>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 授予权限
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>grant</span><span class=w> </span><span class=err>权限列表</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=err>数据库名</span><span class=p>.</span><span class=err>表名</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=s1>&#39;用户名&#39;</span><span class=o>@</span><span class=s1>&#39;主机名&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 给张三用户授予所有权限，在任意数据库任意表上
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>GRANT</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=o>*</span><span class=p>.</span><span class=o>*</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=s1>&#39;zhangsan&#39;</span><span class=o>@</span><span class=s1>&#39;localhost&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=撤销权限>撤销权限<a hidden class=anchor aria-hidden=true href=#撤销权限>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 撤销权限：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>revoke</span><span class=w> </span><span class=err>权限列表</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=err>数据库名</span><span class=p>.</span><span class=err>表名</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=s1>&#39;用户名&#39;</span><span class=o>@</span><span class=s1>&#39;主机名&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>REVOKE</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>db3</span><span class=p>.</span><span class=o>`</span><span class=n>account</span><span class=o>`</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=s1>&#39;lisi&#39;</span><span class=o>@</span><span class=s1>&#39;%&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=dqldata-query-language数据查询语言>DQL(Data Query Language)数据查询语言<a hidden class=anchor aria-hidden=true href=#dqldata-query-language数据查询语言>#</a></h2><h3 id=sql查询的执行顺序>SQL查询的执行顺序<a hidden class=anchor aria-hidden=true href=#sql查询的执行顺序>#</a></h3><h3 id=基础关键字>基础关键字<a hidden class=anchor aria-hidden=true href=#基础关键字>#</a></h3><p>BETWEEN&mldr;AND （在什么之间）和 IN( 集合)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查询年龄大于等于20 小于等于30				
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w>  </span><span class=n>age</span><span class=w> </span><span class=o>&lt;=</span><span class=mi>30</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=k>AND</span><span class=w>  </span><span class=n>age</span><span class=w> </span><span class=o>&lt;=</span><span class=mi>30</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>30</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询年龄22岁，18岁，25岁的信息
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>22</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>18</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>25</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=mi>22</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=mi>25</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>is not null(不为null值) 与 like（模糊查询）、distinct（去除重复值）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查询英语成绩不为null
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>english</span><span class=w>  </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>_</span><span class=p>:</span><span class=err>单个任意字符</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>%</span><span class=err>：多个任意字符</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询姓马的有哪些？ like
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;马%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询姓名第二个字是化的人			
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s2>&#34;_化%&#34;</span><span class=p>;</span><span class=w>				
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询姓名是3个字的人
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;___&#39;</span><span class=p>;</span><span class=w>					
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查询姓名中包含德的人
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%德%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 关键词 DISTINCT 用于返回唯一不同的值。
</span></span></span><span class=line><span class=cl><span class=c1>-- 语法：SELECT DISTINCT 列名称 FROM 表名称
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>NAME</span><span class=w> </span><span class=k>FROM</span><span class=w>  </span><span class=n>student</span><span class=w> </span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=exists>EXISTS<a hidden class=anchor aria-hidden=true href=#exists>#</a></h3><p>EXISTS是返回boolean,不是返回的子查询。</p><p>使用方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>xm</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>EXISTS</span><span class=p>([</span><span class=n>conditions</span><span class=p>]...)</span><span class=w>
</span></span></span></code></pre></div><h3 id=with创建临时表>WITH：创建临时表<a hidden class=anchor aria-hidden=true href=#with创建临时表>#</a></h3><p>with 语句相当于建立了一张 临时虚拟表</p><p>即利用with子句为子查询的数据集作为一个内存临时表. 在内存中解析，提高执行效率.，并且提高SQL语句的可读性，用完即销毁。</p><p>语法
可以同时定义多个临时表</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>With</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>Subtable1</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=mi>1</span><span class=p>...),</span><span class=w> </span><span class=o>//</span><span class=n>as和select中的括号都不能省略</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>Subtable2</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=mi>2</span><span class=p>...),</span><span class=w> </span><span class=o>//</span><span class=err>后面的没有</span><span class=k>with</span><span class=err>，逗号分割，同一个主查询同级别地方，</span><span class=n>with子查询只能定义一次</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=err>…</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>Subtablen</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>n</span><span class=p>...)</span><span class=w> </span><span class=o>//</span><span class=err>与下面的实际查询之间没有逗号</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Select</span><span class=w> </span><span class=err>…</span><span class=p>.</span><span class=w>
</span></span></span></code></pre></div><p>with子句相关总结：</p><p>1.使用with子句可以让子查询重用相同的with查询块,通过select调用（with子句只能被select查询块引用），一般在with查询用到多次情况下。在引用的select语句之前定义,同级只能定义with关键字只能使用一次,多个用逗号分割。
2.with子句的返回结果存到用户的临时表空间中，只做一次查询，反复使用,提高效率。
3.在同级select前有多个查询定义的时候，第1个用with，后面的不用with，并且用逗号隔开。
5.最后一个with 子句与下面的查询之间不能有逗号，只通过右括号分割,with 子句的查询必须用括号括起来
6.如果定义了with子句，而在查询中不使用，那么会报ora-32035 错误：未引用在with子句中定义的查询名。（至少一个with查询的name未被引用，解决方法是移除未被引用的with查询），注意：只要后面有引用的就可以，不一定非要在主查询中引用，比如后面的with
查询也引用了，也是可以的。
7.前面的with子句定义的查询在后面的with子句中可以使用。但是一个with子句内部不能嵌套with子句。
8.当一个查询块名字和一个表名或其他的对象相同时，解析器从内向外搜索，优先使用子查询块名字。
9.with查询的结果列有别名，引用的时候必须使用别名或*。
————————————————
版权声明：本文为CSDN博主「事后诸葛亮」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/zq9017197/article/details/5938514</p><h3 id=order-by字段排序>ORDER BY：字段排序<a hidden class=anchor aria-hidden=true href=#order-by字段排序>#</a></h3><p>语法：order by 子句</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=err>排序字段</span><span class=mi>1</span><span class=w> </span><span class=err>排序方式</span><span class=mi>1</span><span class=w> </span><span class=err>，</span><span class=w>  </span><span class=err>排序字段</span><span class=mi>2</span><span class=w> </span><span class=err>排序方式</span><span class=mi>2</span><span class=p>...</span><span class=w>
</span></span></span></code></pre></div><p>注意：
如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件。</p><p><strong>如果使用默认的 utf8mb4 字符编码，中文按照偏旁部首进行排序，拼音排序用<code>ORDER BY CONVERT(列名 USING GBK) ASC/DESC</code></strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 例子
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>math</span><span class=p>;</span><span class=w> </span><span class=c1>--默认升序
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>math</span><span class=w> </span><span class=k>desc</span><span class=p>;</span><span class=w> </span><span class=c1>--降序
</span></span></span></code></pre></div><h3 id=group-by字段分组>GROUP BY：字段分组<a hidden class=anchor aria-hidden=true href=#group-by字段分组>#</a></h3><p><strong>group by的过程解析</strong></p><p>如图所示，使用GROUP BY name，就相当于使用name进行分组，name相同的都压缩到一行中去，如表3。</p><p>然饿，因为每一行只能允许存在一个确定的值，所以需要对这种有多个的值的格子，进行多个输入、一个输出的聚合函数进行处理。</p><p>所以说<strong>GROUP BY能查询的字段只有分组字段、聚合函数</strong>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 按照性别分组。分别查询男、女同学的平均分
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>sex</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>math</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>student</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>sex</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p><strong>group by 多个字段</strong></p><p>如group by name,number，我们可以把name和number 看成一个<strong>整体字段</strong>，以他们整体来进行分组的。</p><h4 id=场景对某一列的数目进行筛选>场景：对某一列的数目进行筛选<a hidden class=anchor aria-hidden=true href=#场景对某一列的数目进行筛选>#</a></h4><p>比如至少玩过某两款游戏的玩家ID，就可以用count+group by+having进行条件筛选。比如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>GNAME</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;王者荣耀&#39;</span><span class=p>,</span><span class=s1>&#39;帝国时代&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>player</span><span class=p>.</span><span class=n>PID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>PID</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=having组条件>HAVING：组条件<a hidden class=anchor aria-hidden=true href=#having组条件>#</a></h3><p>HAVING 大多数情况下和结合 GROUP BY 来使用，但不是一定要结合 GROUP BY 来使用</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>cno</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=n>nums</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>tbl_student_class</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>cno</span><span class=w> </span><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=inner-join>INNER JOIN<a hidden class=anchor aria-hidden=true href=#inner-join>#</a></h3><h4 id=隐式内连接>隐式内连接<a hidden class=anchor aria-hidden=true href=#隐式内连接>#</a></h4><p>使用where条件消除无用数据</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查询员工表的名称，性别。部门表的名称
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=n>emp</span><span class=p>.</span><span class=n>gender</span><span class=p>,</span><span class=n>dept</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>emp</span><span class=p>,</span><span class=n>dept</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=o>`</span><span class=n>dept_id</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>t1</span><span class=p>.</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=c1>-- 员工表的姓名
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>t1</span><span class=p>.</span><span class=n>gender</span><span class=p>,</span><span class=c1>-- 员工表的性别
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>    </span><span class=n>t2</span><span class=p>.</span><span class=n>name</span><span class=w> </span><span class=c1>-- 部门表的名称
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>emp</span><span class=w> </span><span class=n>t1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>dept</span><span class=w> </span><span class=n>t2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>t1</span><span class=p>.</span><span class=o>`</span><span class=n>dept_id</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=显式内连接>显式内连接<a hidden class=anchor aria-hidden=true href=#显式内连接>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 语法： 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=err>字段列表</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=err>表名</span><span class=mi>1</span><span class=w> </span><span class=p>[</span><span class=k>inner</span><span class=p>]</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=err>表名</span><span class=mi>2</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=err>条件</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 例如：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>dept</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=o>`</span><span class=n>dept_id</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>;</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>dept</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=o>`</span><span class=n>dept_id</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>;</span><span class=w> 
</span></span></span></code></pre></div><h3 id=外连接查询>外连接查询<a hidden class=anchor aria-hidden=true href=#外连接查询>#</a></h3><h4 id=left-join>LEFT JOIN<a hidden class=anchor aria-hidden=true href=#left-join>#</a></h4><p>左外连接 &ndash; 查询的是左表所有数据以及其交集部分</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 语法：select 字段列表 from 表1 left [outer] join 表2 on 条件；
</span></span></span><span class=line><span class=cl><span class=c1>-- 例子：
</span></span></span><span class=line><span class=cl><span class=c1>-- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w>  </span><span class=n>t1</span><span class=p>.</span><span class=o>*</span><span class=p>,</span><span class=n>t2</span><span class=p>.</span><span class=o>`</span><span class=n>name</span><span class=o>`</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>t1</span><span class=w> </span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>dept</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=o>`</span><span class=n>dept_id</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=right-join>RIGHT JOIN<a hidden class=anchor aria-hidden=true href=#right-join>#</a></h4><p>右外连接 &ndash; 查询的是右表所有数据以及其交集部分</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 语法：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=err>字段列表</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=err>表</span><span class=mi>1</span><span class=w> </span><span class=k>right</span><span class=w> </span><span class=p>[</span><span class=k>outer</span><span class=p>]</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=err>表</span><span class=mi>2</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=err>条件；</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 例子：
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w>  </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>dept</span><span class=w> </span><span class=n>t2</span><span class=w> </span><span class=k>RIGHT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>t1</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>t1</span><span class=p>.</span><span class=o>`</span><span class=n>dept_id</span><span class=o>`</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>t2</span><span class=p>.</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h3 id=case-子句>CASE 子句<a hidden class=anchor aria-hidden=true href=#case-子句>#</a></h3><p>Case具有两种格式。简单Case函数和Case搜索函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>--简单Case函数
</span></span><span class=line><span class=cl>CASE sex
</span></span><span class=line><span class=cl>	WHEN &#39;1&#39; THEN &#39;男&#39;
</span></span><span class=line><span class=cl>	WHEN &#39;2&#39; THEN &#39;女&#39;
</span></span><span class=line><span class=cl>ELSE &#39;其他&#39; END
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--Case搜索函数
</span></span><span class=line><span class=cl>CASE 
</span></span><span class=line><span class=cl>	WHEN sex = &#39;1&#39; THEN &#39;男&#39;
</span></span><span class=line><span class=cl>	WHEN sex = &#39;2&#39; THEN &#39;女&#39;
</span></span><span class=line><span class=cl>ELSE &#39;其他&#39; END
</span></span></code></pre></div><p>这两种方式，可以实现相同的功能。简单Case函数的写法相对比较简洁，但是和Case搜索函数相比，功能方面会有些限制，比如写判断式。</p><p>使用示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>battle</span><span class=w> </span><span class=k>ON</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>CASE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=k>WHEN</span><span class=w> </span><span class=n>battle</span><span class=p>.</span><span class=n>WINNER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PLAYER1&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>battle</span><span class=p>.</span><span class=n>PLAYER1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=k>WHEN</span><span class=w> </span><span class=n>battle</span><span class=p>.</span><span class=n>WINNER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PLAYER2&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>battle</span><span class=p>.</span><span class=n>PLAYER2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>					</span><span class=k>ELSE</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=c1>-- 如果 WINNER 不是 &#39;PLAYER1&#39; 或 &#39;PLAYER2&#39;，可以返回 NULL 或其他适当的值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>		</span><span class=k>END</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>player</span><span class=p>.</span><span class=n>PID</span><span class=w>
</span></span></span></code></pre></div><h1 id=外键>外键<a hidden class=anchor aria-hidden=true href=#外键>#</a></h1><h3 id=外键的设置>外键的设置<a hidden class=anchor aria-hidden=true href=#外键的设置>#</a></h3><p>用SQL语言设置外键：`[ CONSTRAINT `外键别名`] FOREIGN KEY (`受限制的列名`) REFERENCES `引用的表` (`引用的列名`)`</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=o>`</span><span class=n>S</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>xh</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=nb>CHARACTER</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=n>utf8mb4</span><span class=w> </span><span class=k>COLLATE</span><span class=w> </span><span class=n>utf8mb4_0900_ai_ci</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>xm</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>xb</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>csrq</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>jg</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>sjhm</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>xh</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=n>idx1</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=o>`</span><span class=n>xm</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>BTREE</span><span class=w> </span><span class=cm>/*!80000 INVISIBLE */</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>KEY</span><span class=w> </span><span class=o>`</span><span class=err>学生表</span><span class=n>S院系号</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=o>`</span><span class=err>学生表</span><span class=n>S院系号</span><span class=o>`</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=o>`</span><span class=n>D</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8mb4</span><span class=w> </span><span class=k>COLLATE</span><span class=o>=</span><span class=n>utf8mb4_0900_ai_ci</span><span class=w>
</span></span></span></code></pre></div><p>外键是各个表之间的约束和联系，让数据更加合理。</p><p><img loading=lazy src=https://raw.githubusercontent.com/sirius2alpha/Typora-pics/master/2023/09/upgit_20230907_1694084689.png alt=image-20230907190449116></p><p>外键设置后，对添加和删除数据元素就有了先后顺序的要求。</p><h3 id=添加记录会出现的错误>添加记录会出现的错误<a hidden class=anchor aria-hidden=true href=#添加记录会出现的错误>#</a></h3><p>如果想要在学生表S中添加院系号为04的学生，直接执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=o>`</span><span class=n>dbclass</span><span class=o>-</span><span class=n>school</span><span class=o>`</span><span class=p>.</span><span class=o>`</span><span class=n>S</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>xh</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>xm</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>xb</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>csrq</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>jg</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>sjhm</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;1108&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Kelvin&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;男&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1993-08-16&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;加州&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;16301254638&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;05&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>会出现报错：</p><pre tabindex=0><code>ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`dbclass-school`.`S`, CONSTRAINT `学生表S院系号` FOREIGN KEY (`yxh`) REFERENCES `D` (`yxh`))
</code></pre><h3 id=删除记录会出现的错误>删除记录会出现的错误<a hidden class=anchor aria-hidden=true href=#删除记录会出现的错误>#</a></h3><p>在被引用的外键D.yxh删除记录，也会出现报错。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>yxh</span><span class=o>=</span><span class=s1>&#39;01&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ERROR</span><span class=w> </span><span class=mi>1451</span><span class=w> </span><span class=p>(</span><span class=mi>23000</span><span class=p>):</span><span class=w> </span><span class=n>Cannot</span><span class=w> </span><span class=k>delete</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>update</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>parent</span><span class=w> </span><span class=k>row</span><span class=p>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>foreign</span><span class=w> </span><span class=k>key</span><span class=w> </span><span class=k>constraint</span><span class=w> </span><span class=n>fails</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>dbclass</span><span class=o>-</span><span class=n>school</span><span class=o>`</span><span class=p>.</span><span class=o>`</span><span class=n>S</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=o>`</span><span class=err>学生表</span><span class=n>S院系号</span><span class=o>`</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=o>`</span><span class=n>D</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>))</span><span class=w>
</span></span></span></code></pre></div><h3 id=正确的增删顺序是必要的>正确的增删顺序是必要的<a hidden class=anchor aria-hidden=true href=#正确的增删顺序是必要的>#</a></h3><h4 id=有顺序地增加记录>有顺序地增加记录<a hidden class=anchor aria-hidden=true href=#有顺序地增加记录>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>#</span><span class=w> </span><span class=err>先添加</span><span class=n>D表中的院系号yxh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=o>`</span><span class=n>dbclass</span><span class=o>-</span><span class=n>school</span><span class=o>`</span><span class=p>.</span><span class=o>`</span><span class=n>D</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>,</span><span class=o>`</span><span class=n>Mc</span><span class=o>`</span><span class=p>,</span><span class=o>`</span><span class=n>dz</span><span class=o>`</span><span class=p>,</span><span class=o>`</span><span class=n>lxdh</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=p>(</span><span class=s1>&#39;04&#39;</span><span class=p>,</span><span class=s1>&#39;美术学院&#39;</span><span class=p>,</span><span class=s1>&#39;上大东校区五号楼&#39;</span><span class=p>,</span><span class=s1>&#39;1234675427&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>affected</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>D</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-----+-----------------+--------------------------+------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>yxh</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Mc</span><span class=w>              </span><span class=o>|</span><span class=w> </span><span class=n>dz</span><span class=w>                       </span><span class=o>|</span><span class=w> </span><span class=n>lxdh</span><span class=w>       </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-----+-----------------+--------------------------+------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>计算机学院</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>上大东校区三号楼</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=mi>65347567</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>02</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>通讯学院</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=err>上大东校区二号楼</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=mi>65341234</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>03</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>材料学院</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=err>上大东校区四号楼</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=mi>65347890</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>04</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=err>美术学院</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=err>上大东校区五号楼</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=mi>1234675427</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-----+-----------------+--------------------------+------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>4</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>之后才能插入该院系号的学生</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=o>`</span><span class=n>dbclass</span><span class=o>-</span><span class=n>school</span><span class=o>`</span><span class=p>.</span><span class=o>`</span><span class=n>S</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>xh</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>xm</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>xb</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>csrq</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>jg</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>sjhm</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;1109&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;Eva&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;女&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;1993-08-16&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;加州&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;16301254638&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;04&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>affected</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------+-----------+------+------------+--------+-------------+------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>xh</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>xm</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=n>xb</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>csrq</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=n>jg</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>sjhm</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=n>yxh</span><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------+-----------+------+------------+--------+-------------+------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=mi>1101</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李明</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1993</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>06</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>上海</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>13613005486</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>02</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1102</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>刘晓明</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1992</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>08</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>安徽</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>18913457890</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1103</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张颖</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1993</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>05</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>江苏</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>18826490423</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1104</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>刘晶晶</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1994</span><span class=o>-</span><span class=mi>11</span><span class=o>-</span><span class=mi>06</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>上海</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>13331934111</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1105</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>刘成刚</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1991</span><span class=o>-</span><span class=mi>06</span><span class=o>-</span><span class=mi>07</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>上海</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>18015872567</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1106</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>李二丽</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1993</span><span class=o>-</span><span class=mi>05</span><span class=o>-</span><span class=mi>04</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>江苏</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>18107620945</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1107</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>张晓峰</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1992</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mi>16</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>浙江</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>13912341078</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>01</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1108</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Kelvin</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=err>男</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1993</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mi>16</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>加州</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>16301254638</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>03</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=mi>1109</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Eva</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=err>女</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>1993</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mi>16</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=err>加州</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>16301254638</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>04</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------+-----------+------+------------+--------+-------------+------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>9</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h4 id=有顺序地删除记录>有顺序地删除记录<a hidden class=anchor aria-hidden=true href=#有顺序地删除记录>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>#</span><span class=w> </span><span class=err>在外键被引用的时候不能直接删除被引用的内容</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>DELETE</span><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>yxh</span><span class=o>=</span><span class=mi>04</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ERROR</span><span class=w> </span><span class=mi>1451</span><span class=w> </span><span class=p>(</span><span class=mi>23000</span><span class=p>):</span><span class=w> </span><span class=n>Cannot</span><span class=w> </span><span class=k>delete</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=k>update</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>parent</span><span class=w> </span><span class=k>row</span><span class=p>:</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>foreign</span><span class=w> </span><span class=k>key</span><span class=w> </span><span class=k>constraint</span><span class=w> </span><span class=n>fails</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>dbclass</span><span class=o>-</span><span class=n>school</span><span class=o>`</span><span class=p>.</span><span class=o>`</span><span class=n>S</span><span class=o>`</span><span class=p>,</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=o>`</span><span class=err>学生表</span><span class=n>S院系号</span><span class=o>`</span><span class=w> </span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=o>`</span><span class=n>D</span><span class=o>`</span><span class=w> </span><span class=p>(</span><span class=o>`</span><span class=n>yxh</span><span class=o>`</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>应该先删除学生表中引用该院系号的记录</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>S</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>yxh</span><span class=o>=</span><span class=mi>04</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>affected</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>最后才能删除逻辑上最底层的记录</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>mysql</span><span class=o>&gt;</span><span class=w> </span><span class=k>DELETE</span><span class=w>  </span><span class=k>FROM</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>yxh</span><span class=o>=</span><span class=mi>04</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Query</span><span class=w> </span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>affected</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h1 id=错误提示>错误提示<a hidden class=anchor aria-hidden=true href=#错误提示>#</a></h1><p><strong>Operand should contain 1 column(s)</strong></p><p>原因是我的子查询查询出的数据不止一个字段，但是我却在整体SQL中 把子查询出来的结果 作为一个字段的 NODE_ID 了</p><p><strong>SQL 参数错误</strong></p><p>这个问题的原因有很多，下面列出碰到的不易看出错误的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>rank</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>player</span><span class=p>.</span><span class=n>RANK</span><span class=o>=</span><span class=n>rank</span><span class=p>.</span><span class=n>RID</span><span class=w>
</span></span></span></code></pre></div><p>应该改为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=o>`</span><span class=n>rank</span><span class=o>`</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>player</span><span class=p>.</span><span class=n>RANK</span><span class=o>=`</span><span class=n>rank</span><span class=o>`</span><span class=p>.</span><span class=n>RID</span><span class=w>
</span></span></span></code></pre></div><p>因为rank是sql中的保留关键字，作为表名需要用``括起来，当然最好是不要使用这样的名字作为表名。</p></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/sql/>SQL</a></li><li><a href=//localhost:1313/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/>学习笔记</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/posts/notes/network/network-commands/><span class=title>« Prev</span><br><span>常用的网络命令</span>
</a><a class=next href=//localhost:1313/posts/notes/network/network-review/><span class=title>Next »</span><br><span>计算机网络期末复习</span></a></nav></footer><script>function createGiscusScript(e){const t=document.createElement("script");Object.entries(e).forEach(([e,n])=>t.setAttribute(e,n)),document.querySelector("article").appendChild(t);const n=document.querySelector('label[for="switch_default"]');n&&n.addEventListener("click",function(){const e=document.body.classList.contains("dark")?"transparent_dark":"light";t.setAttribute("data-theme",e),sendMessage({setConfig:{theme:e}})})}function sendMessage(e){const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")}document.addEventListener("DOMContentLoaded",function(){const e={src:"https://giscus.app/client.js","data-repo":"yunyit/yunyit.github.io","data-repo-id":"R_kgDOKqkPYw","data-category":"Comments","data-category-id":"DIC_kwDOKqkPY84CceDi","data-mapping":"url","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-lang":"en",crossorigin:"anonymous",async:""};e["data-theme"]=document.body.classList.contains("dark")?"transparent_dark":"light",createGiscusScript(e);const t=new MutationObserver(()=>{const e=document.body.classList.contains("dark")?"transparent_dark":"light";sendMessage({setConfig:{theme:e}})});t.observe(document.body,{attributes:!0,attributeFilter:["class"]})})</script></article></main><footer class=footer><span><a href=https://us.umami.is/websites/5e6ac0c1-e2b2-4d0f-9542-b79ac2cf89c4 rel="noopener noreferrer" target=_blank>Analysis</a>
</span>|
<script defer src=https://cloud.umami.is/script.js data-website-id=5e6ac0c1-e2b2-4d0f-9542-b79ac2cf89c4></script><span><a href=https://beian.miit.gov.cn/ target=_blank>渝ICP备2024018631号</a>
</span>|
<span>&copy; 2024 <a href=//localhost:1313/>Sirius' Blog</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>